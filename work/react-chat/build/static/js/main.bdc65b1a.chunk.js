(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(7),o=n.n(c),s=(n(13),n(1)),u=(n(6),function(e){e.user;var t=e.onLogin,n=Object(a.useState)(""),c=Object(s.a)(n,2),o=c[0],u=c[1],i=Object(a.useState)(!1),l=Object(s.a)(i,2),m=l[0],f=l[1],h=Object(a.useState)(""),d=Object(s.a)(h,2),E=d[0],g=d[1];return r.a.createElement("div",{className:"login"},r.a.createElement("p",{className:"error"},o),m?r.a.createElement("span",null,"Loading..."):r.a.createElement("div",null,r.a.createElement("p",null,"Join the chat room"),r.a.createElement("div",{className:"input-username"},r.a.createElement("input",{placeholder:"Username",onChange:function(e){return g(e.target.value)}}),r.a.createElement("button",{onClick:function(){E?(u(""),f(!0),function(e){return fetch("/login",{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({username:e})}).catch((function(){return Promise.reject({code:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))}(E).then((function(){return t(E)})).catch((function(e){u(e.message),f(!1)}))):u("No username.")}},"Login"))))}),i=n(4),l=function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(""),u=Object(s.a)(o,2),l=u[0],m=u[1],f=Object(a.useState)(""),h=Object(s.a)(f,2),d=h[0],E=h[1];Object(a.useEffect)((function(){fetch("/messages",{method:"GET"}).catch((function(){return Promise.reject({code:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(e){m(e)}))}),[]);var g=function(){var e;(e=d,fetch("/addMessage",{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({text:e})}).catch((function(){return Promise.reject({code:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))).then((function(e){var t=Object(i.a)(l);t.push(e),m(t),E("")})).catch((function(e){c(e.message)}))},j=Object(i.a)(l).map((function(e){return r.a.createElement("li",{key:e.timestamp},r.a.createElement("span",{className:"chat-person"},e.sender),r.a.createElement("span",{className:"chat-time"},e.timestamp),r.a.createElement("br",null),r.a.createElement("p",{className:"chat-message"},e.text))}));return r.a.createElement("div",{className:"out-going"},r.a.createElement("div",{className:"message-panel"},r.a.createElement("p",{className:"error"},n),j),r.a.createElement("div",null,r.a.createElement("input",{value:d,className:"to-send",placeholder:"Type the message",onChange:function(e){return E(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?g():null}}),r.a.createElement("button",{onClick:g},"Send")))};function m(e){var t=e.username,n=Object(a.useState)(""),c=Object(s.a)(n,2),o=c[0],u=c[1];Object(a.useEffect)((function(){fetch("/activeUsers",{method:"GET"}).catch((function(){return Promise.reject({code:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(e){u(e)}))}),[]);var i=Object.values(o).map((function(e){return r.a.createElement("li",{className:"user-name",key:e.uid},e.username)}));return r.a.createElement("div",{className:"user-panel"},r.a.createElement("div",{className:"welcome"},"Hello ",t," \u30c4"),r.a.createElement("div",{className:"user-title"},r.a.createElement("span",null,"Active people")),i)}var f=function(e){var t=e.onLogout;return r.a.createElement("div",{className:"logout"},r.a.createElement("button",{onClick:function(){fetch("/logout",{method:"POST"}).then((function(e){e.ok})).then((function(){return t()}))}},"Logout"))};function h(){var e=Object(a.useState)({isLoggedIn:!1,username:""}),t=Object(s.a)(e,2),n=t[0],c=t[1];Object(a.useEffect)((function(){fetch("/session",{method:"GET"}).catch((function(){return Promise.reject({code:"network-error"})})).then((function(e){return e.ok?e.json():Promise.reject({code:"login-invalid"})})).then((function(e){c({isLoggedIn:!0,username:e.username})}))}),[]);return r.a.createElement("div",null,n.isLoggedIn?r.a.createElement("div",{className:"chat-app"},r.a.createElement("div",{className:"display-panel"},r.a.createElement(m,{username:n.username}),r.a.createElement(l,null)),r.a.createElement("div",{className:"logout-panel"},r.a.createElement(f,{onLogout:function(){c({isLoggedIn:!1,username:""})}}))):r.a.createElement(u,{user:n,onLogin:function(e){c({isLoggedIn:!0,username:e})}}))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(h,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},6:function(e,t,n){},8:function(e,t,n){e.exports=n(14)}},[[8,1,2]]]);
//# sourceMappingURL=main.bdc65b1a.chunk.js.map